// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package snowflake

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-snowflake/sdk/v2/go/snowflake/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// !> **Caution: Preview Feature** This feature is considered a preview feature in the provider, regardless of the state of the resource in Snowflake. We do not guarantee its stability. It will be reworked and marked as a stable feature in future releases. Breaking changes are expected, even without bumping the major version. To use this feature, add the relevant feature name to `previewFeaturesEnabled` field in the provider configuration. Please always refer to the Getting Help section in our Github repo to best determine how to get help for your questions.
//
// !> **Note** According to Snowflake [docs](https://docs.snowflake.com/en/sql-reference/sql/drop-authentication-policy#usage-notes), an authentication policy cannot be dropped successfully if it is currently assigned to another object. Currently, the provider does not unassign such objects automatically. Before dropping the resource, first unassign the policy from the relevant objects. See guide for more details.
//
// > **Note** External changes are not detected for the following fields: `mfaPolicy`, `patPolicy`, `workloadIdentityPolicy`. Also, they cannot be imported and should be manually set to the correct values during the import operation.
//
// Resource used to manage authentication policy objects. For more information, check [authentication policy documentation](https://docs.snowflake.com/en/sql-reference/sql/create-authentication-policy).
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-snowflake/sdk/v2/go/snowflake"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			// # Minimal
//			_, err := snowflake.NewAuthenticationPolicy(ctx, "basic", &snowflake.AuthenticationPolicyArgs{
//				Database: pulumi.String("database_name"),
//				Schema:   pulumi.String("schema_name"),
//				Name:     pulumi.String("network_policy_name"),
//			})
//			if err != nil {
//				return err
//			}
//			// # Complete (with every optional set)
//			_, err = snowflake.NewAuthenticationPolicy(ctx, "complete", &snowflake.AuthenticationPolicyArgs{
//				Database: pulumi.String("database_name"),
//				Schema:   pulumi.String("schema_name"),
//				Name:     pulumi.String("network_policy_name"),
//				AuthenticationMethods: pulumi.StringArray{
//					pulumi.String("ALL"),
//				},
//				MfaEnrollment: pulumi.String("OPTIONAL"),
//				ClientTypes: pulumi.StringArray{
//					pulumi.String("ALL"),
//				},
//				SecurityIntegrations: pulumi.StringArray{
//					pulumi.String("ALL"),
//				},
//				MfaPolicy: &snowflake.AuthenticationPolicyMfaPolicyArgs{
//					AllowedMethods: pulumi.StringArray{
//						pulumi.String("PASSKEY"),
//						pulumi.String("DUO"),
//					},
//					EnforceMfaOnExternalAuthentication: pulumi.String("ALL"),
//				},
//				PatPolicy: &snowflake.AuthenticationPolicyPatPolicyArgs{
//					DefaultExpiryInDays:     pulumi.Int(1),
//					MaxExpiryInDays:         pulumi.Int(30),
//					NetworkPolicyEvaluation: pulumi.String("NOT_ENFORCED"),
//				},
//				WorkloadIdentityPolicy: &snowflake.AuthenticationPolicyWorkloadIdentityPolicyArgs{
//					AllowedProviders: pulumi.StringArray{
//						pulumi.String("ALL"),
//					},
//					AllowedAwsAccounts: pulumi.StringArray{
//						pulumi.String("111122223333"),
//					},
//					AllowedAzureIssuers: pulumi.StringArray{
//						pulumi.String("https://login.microsoftonline.com/tenantid/v2.0"),
//					},
//					AllowedOidcIssuers: pulumi.StringArray{
//						pulumi.String("https://example.com"),
//					},
//				},
//				Comment: pulumi.String("My authentication policy."),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// > **Note** Instead of using fully_qualified_name, you can reference objects managed outside Terraform by constructing a correct ID, consult identifiers guide.
// <!-- TODO(SNOW-1634854): include an example showing both methods-->
//
// > **Note** If a field has a default value, it is shown next to the type in the schema.
//
// ## Import
//
// The `pulumi import` command can be used, for example:
//
// ```sh
// $ pulumi import snowflake:index/authenticationPolicy:AuthenticationPolicy example '"<database_name>"."<schema_name>"."<authentication_policy_name>"'
// ```
type AuthenticationPolicy struct {
	pulumi.CustomResourceState

	// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
	AuthenticationMethods pulumi.StringArrayOutput `pulumi:"authenticationMethods"`
	// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
	ClientTypes pulumi.StringArrayOutput `pulumi:"clientTypes"`
	// Specifies a comment for the authentication policy.
	Comment pulumi.StringPtrOutput `pulumi:"comment"`
	// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Database pulumi.StringOutput `pulumi:"database"`
	// Outputs the result of `DESCRIBE AUTHENTICATION POLICY` for the given policy.
	DescribeOutputs AuthenticationPolicyDescribeOutputArrayOutput `pulumi:"describeOutputs"`
	// Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
	FullyQualifiedName pulumi.StringOutput `pulumi:"fullyQualifiedName"`
	// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
	//
	// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
	MfaAuthenticationMethods pulumi.StringArrayOutput `pulumi:"mfaAuthenticationMethods"`
	// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
	MfaEnrollment pulumi.StringPtrOutput `pulumi:"mfaEnrollment"`
	// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
	MfaPolicy AuthenticationPolicyMfaPolicyPtrOutput `pulumi:"mfaPolicy"`
	// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Name pulumi.StringOutput `pulumi:"name"`
	// Specifies the policy for programmatic access tokens.
	PatPolicy AuthenticationPolicyPatPolicyPtrOutput `pulumi:"patPolicy"`
	// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Schema pulumi.StringOutput `pulumi:"schema"`
	// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
	SecurityIntegrations pulumi.StringArrayOutput `pulumi:"securityIntegrations"`
	// Outputs the result of `SHOW AUTHENTICATION POLICIES` for the given policy.
	ShowOutputs AuthenticationPolicyShowOutputArrayOutput `pulumi:"showOutputs"`
	// Specifies the policy for workload identity federation.
	WorkloadIdentityPolicy AuthenticationPolicyWorkloadIdentityPolicyPtrOutput `pulumi:"workloadIdentityPolicy"`
}

// NewAuthenticationPolicy registers a new resource with the given unique name, arguments, and options.
func NewAuthenticationPolicy(ctx *pulumi.Context,
	name string, args *AuthenticationPolicyArgs, opts ...pulumi.ResourceOption) (*AuthenticationPolicy, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Database == nil {
		return nil, errors.New("invalid value for required argument 'Database'")
	}
	if args.Schema == nil {
		return nil, errors.New("invalid value for required argument 'Schema'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource AuthenticationPolicy
	err := ctx.RegisterResource("snowflake:index/authenticationPolicy:AuthenticationPolicy", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetAuthenticationPolicy gets an existing AuthenticationPolicy resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetAuthenticationPolicy(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *AuthenticationPolicyState, opts ...pulumi.ResourceOption) (*AuthenticationPolicy, error) {
	var resource AuthenticationPolicy
	err := ctx.ReadResource("snowflake:index/authenticationPolicy:AuthenticationPolicy", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering AuthenticationPolicy resources.
type authenticationPolicyState struct {
	// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
	AuthenticationMethods []string `pulumi:"authenticationMethods"`
	// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
	ClientTypes []string `pulumi:"clientTypes"`
	// Specifies a comment for the authentication policy.
	Comment *string `pulumi:"comment"`
	// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Database *string `pulumi:"database"`
	// Outputs the result of `DESCRIBE AUTHENTICATION POLICY` for the given policy.
	DescribeOutputs []AuthenticationPolicyDescribeOutput `pulumi:"describeOutputs"`
	// Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
	FullyQualifiedName *string `pulumi:"fullyQualifiedName"`
	// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
	//
	// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
	MfaAuthenticationMethods []string `pulumi:"mfaAuthenticationMethods"`
	// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
	MfaEnrollment *string `pulumi:"mfaEnrollment"`
	// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
	MfaPolicy *AuthenticationPolicyMfaPolicy `pulumi:"mfaPolicy"`
	// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Name *string `pulumi:"name"`
	// Specifies the policy for programmatic access tokens.
	PatPolicy *AuthenticationPolicyPatPolicy `pulumi:"patPolicy"`
	// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Schema *string `pulumi:"schema"`
	// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
	SecurityIntegrations []string `pulumi:"securityIntegrations"`
	// Outputs the result of `SHOW AUTHENTICATION POLICIES` for the given policy.
	ShowOutputs []AuthenticationPolicyShowOutput `pulumi:"showOutputs"`
	// Specifies the policy for workload identity federation.
	WorkloadIdentityPolicy *AuthenticationPolicyWorkloadIdentityPolicy `pulumi:"workloadIdentityPolicy"`
}

type AuthenticationPolicyState struct {
	// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
	AuthenticationMethods pulumi.StringArrayInput
	// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
	ClientTypes pulumi.StringArrayInput
	// Specifies a comment for the authentication policy.
	Comment pulumi.StringPtrInput
	// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Database pulumi.StringPtrInput
	// Outputs the result of `DESCRIBE AUTHENTICATION POLICY` for the given policy.
	DescribeOutputs AuthenticationPolicyDescribeOutputArrayInput
	// Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
	FullyQualifiedName pulumi.StringPtrInput
	// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
	//
	// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
	MfaAuthenticationMethods pulumi.StringArrayInput
	// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
	MfaEnrollment pulumi.StringPtrInput
	// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
	MfaPolicy AuthenticationPolicyMfaPolicyPtrInput
	// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Name pulumi.StringPtrInput
	// Specifies the policy for programmatic access tokens.
	PatPolicy AuthenticationPolicyPatPolicyPtrInput
	// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Schema pulumi.StringPtrInput
	// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
	SecurityIntegrations pulumi.StringArrayInput
	// Outputs the result of `SHOW AUTHENTICATION POLICIES` for the given policy.
	ShowOutputs AuthenticationPolicyShowOutputArrayInput
	// Specifies the policy for workload identity federation.
	WorkloadIdentityPolicy AuthenticationPolicyWorkloadIdentityPolicyPtrInput
}

func (AuthenticationPolicyState) ElementType() reflect.Type {
	return reflect.TypeOf((*authenticationPolicyState)(nil)).Elem()
}

type authenticationPolicyArgs struct {
	// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
	AuthenticationMethods []string `pulumi:"authenticationMethods"`
	// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
	ClientTypes []string `pulumi:"clientTypes"`
	// Specifies a comment for the authentication policy.
	Comment *string `pulumi:"comment"`
	// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Database string `pulumi:"database"`
	// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
	//
	// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
	MfaAuthenticationMethods []string `pulumi:"mfaAuthenticationMethods"`
	// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
	MfaEnrollment *string `pulumi:"mfaEnrollment"`
	// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
	MfaPolicy *AuthenticationPolicyMfaPolicy `pulumi:"mfaPolicy"`
	// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Name *string `pulumi:"name"`
	// Specifies the policy for programmatic access tokens.
	PatPolicy *AuthenticationPolicyPatPolicy `pulumi:"patPolicy"`
	// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Schema string `pulumi:"schema"`
	// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
	SecurityIntegrations []string `pulumi:"securityIntegrations"`
	// Specifies the policy for workload identity federation.
	WorkloadIdentityPolicy *AuthenticationPolicyWorkloadIdentityPolicy `pulumi:"workloadIdentityPolicy"`
}

// The set of arguments for constructing a AuthenticationPolicy resource.
type AuthenticationPolicyArgs struct {
	// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
	AuthenticationMethods pulumi.StringArrayInput
	// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
	ClientTypes pulumi.StringArrayInput
	// Specifies a comment for the authentication policy.
	Comment pulumi.StringPtrInput
	// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Database pulumi.StringInput
	// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
	//
	// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
	MfaAuthenticationMethods pulumi.StringArrayInput
	// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
	MfaEnrollment pulumi.StringPtrInput
	// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
	MfaPolicy AuthenticationPolicyMfaPolicyPtrInput
	// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Name pulumi.StringPtrInput
	// Specifies the policy for programmatic access tokens.
	PatPolicy AuthenticationPolicyPatPolicyPtrInput
	// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
	Schema pulumi.StringInput
	// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
	SecurityIntegrations pulumi.StringArrayInput
	// Specifies the policy for workload identity federation.
	WorkloadIdentityPolicy AuthenticationPolicyWorkloadIdentityPolicyPtrInput
}

func (AuthenticationPolicyArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*authenticationPolicyArgs)(nil)).Elem()
}

type AuthenticationPolicyInput interface {
	pulumi.Input

	ToAuthenticationPolicyOutput() AuthenticationPolicyOutput
	ToAuthenticationPolicyOutputWithContext(ctx context.Context) AuthenticationPolicyOutput
}

func (*AuthenticationPolicy) ElementType() reflect.Type {
	return reflect.TypeOf((**AuthenticationPolicy)(nil)).Elem()
}

func (i *AuthenticationPolicy) ToAuthenticationPolicyOutput() AuthenticationPolicyOutput {
	return i.ToAuthenticationPolicyOutputWithContext(context.Background())
}

func (i *AuthenticationPolicy) ToAuthenticationPolicyOutputWithContext(ctx context.Context) AuthenticationPolicyOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AuthenticationPolicyOutput)
}

// AuthenticationPolicyArrayInput is an input type that accepts AuthenticationPolicyArray and AuthenticationPolicyArrayOutput values.
// You can construct a concrete instance of `AuthenticationPolicyArrayInput` via:
//
//	AuthenticationPolicyArray{ AuthenticationPolicyArgs{...} }
type AuthenticationPolicyArrayInput interface {
	pulumi.Input

	ToAuthenticationPolicyArrayOutput() AuthenticationPolicyArrayOutput
	ToAuthenticationPolicyArrayOutputWithContext(context.Context) AuthenticationPolicyArrayOutput
}

type AuthenticationPolicyArray []AuthenticationPolicyInput

func (AuthenticationPolicyArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AuthenticationPolicy)(nil)).Elem()
}

func (i AuthenticationPolicyArray) ToAuthenticationPolicyArrayOutput() AuthenticationPolicyArrayOutput {
	return i.ToAuthenticationPolicyArrayOutputWithContext(context.Background())
}

func (i AuthenticationPolicyArray) ToAuthenticationPolicyArrayOutputWithContext(ctx context.Context) AuthenticationPolicyArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AuthenticationPolicyArrayOutput)
}

// AuthenticationPolicyMapInput is an input type that accepts AuthenticationPolicyMap and AuthenticationPolicyMapOutput values.
// You can construct a concrete instance of `AuthenticationPolicyMapInput` via:
//
//	AuthenticationPolicyMap{ "key": AuthenticationPolicyArgs{...} }
type AuthenticationPolicyMapInput interface {
	pulumi.Input

	ToAuthenticationPolicyMapOutput() AuthenticationPolicyMapOutput
	ToAuthenticationPolicyMapOutputWithContext(context.Context) AuthenticationPolicyMapOutput
}

type AuthenticationPolicyMap map[string]AuthenticationPolicyInput

func (AuthenticationPolicyMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AuthenticationPolicy)(nil)).Elem()
}

func (i AuthenticationPolicyMap) ToAuthenticationPolicyMapOutput() AuthenticationPolicyMapOutput {
	return i.ToAuthenticationPolicyMapOutputWithContext(context.Background())
}

func (i AuthenticationPolicyMap) ToAuthenticationPolicyMapOutputWithContext(ctx context.Context) AuthenticationPolicyMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AuthenticationPolicyMapOutput)
}

type AuthenticationPolicyOutput struct{ *pulumi.OutputState }

func (AuthenticationPolicyOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**AuthenticationPolicy)(nil)).Elem()
}

func (o AuthenticationPolicyOutput) ToAuthenticationPolicyOutput() AuthenticationPolicyOutput {
	return o
}

func (o AuthenticationPolicyOutput) ToAuthenticationPolicyOutputWithContext(ctx context.Context) AuthenticationPolicyOutput {
	return o
}

// A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
func (o AuthenticationPolicyOutput) AuthenticationMethods() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringArrayOutput { return v.AuthenticationMethods }).(pulumi.StringArrayOutput)
}

// A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `clientTypes`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `clientTypes` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
func (o AuthenticationPolicyOutput) ClientTypes() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringArrayOutput { return v.ClientTypes }).(pulumi.StringArrayOutput)
}

// Specifies a comment for the authentication policy.
func (o AuthenticationPolicyOutput) Comment() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringPtrOutput { return v.Comment }).(pulumi.StringPtrOutput)
}

// The database in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
func (o AuthenticationPolicyOutput) Database() pulumi.StringOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringOutput { return v.Database }).(pulumi.StringOutput)
}

// Outputs the result of `DESCRIBE AUTHENTICATION POLICY` for the given policy.
func (o AuthenticationPolicyOutput) DescribeOutputs() AuthenticationPolicyDescribeOutputArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) AuthenticationPolicyDescribeOutputArrayOutput { return v.DescribeOutputs }).(AuthenticationPolicyDescribeOutputArrayOutput)
}

// Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
func (o AuthenticationPolicyOutput) FullyQualifiedName() pulumi.StringOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringOutput { return v.FullyQualifiedName }).(pulumi.StringOutput)
}

// A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
//
// Deprecated: This field is deprecated and will be removed in the future. The new field `ENFORCE_MFA_ON_EXTERNAL_AUTHENTICATION` will be added in the next versions of the provider. Read our [BCR Migration Guide](https://github.com/snowflakedb/terraform-provider-snowflake/blob/main/SNOWFLAKE_BCR_MIGRATION_GUIDE.md#changes-in-authentication-policies) for more migration steps and more details.
func (o AuthenticationPolicyOutput) MfaAuthenticationMethods() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringArrayOutput { return v.MfaAuthenticationMethods }).(pulumi.StringArrayOutput)
}

// Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `clientTypes` parameter must include `snowflakeUi`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA). Note that when you set this value to OPTIONAL, and your account setup forces users to enroll in MFA, then Snowflake may set quietly this value to `REQUIRED_PASSWORD_ONLY`, which may cause permadiff. In this case, you may want to adjust this field value.
func (o AuthenticationPolicyOutput) MfaEnrollment() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringPtrOutput { return v.MfaEnrollment }).(pulumi.StringPtrOutput)
}

// Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication.
func (o AuthenticationPolicyOutput) MfaPolicy() AuthenticationPolicyMfaPolicyPtrOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) AuthenticationPolicyMfaPolicyPtrOutput { return v.MfaPolicy }).(AuthenticationPolicyMfaPolicyPtrOutput)
}

// Specifies the identifier for the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
func (o AuthenticationPolicyOutput) Name() pulumi.StringOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringOutput { return v.Name }).(pulumi.StringOutput)
}

// Specifies the policy for programmatic access tokens.
func (o AuthenticationPolicyOutput) PatPolicy() AuthenticationPolicyPatPolicyPtrOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) AuthenticationPolicyPatPolicyPtrOutput { return v.PatPolicy }).(AuthenticationPolicyPatPolicyPtrOutput)
}

// The schema in which to create the authentication policy. Due to technical limitations (read more here), avoid using the following characters: `|`, `.`, `"`.
func (o AuthenticationPolicyOutput) Schema() pulumi.StringOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringOutput { return v.Schema }).(pulumi.StringOutput)
}

// A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authenticationMethods` list. All values in the `securityIntegrations` list must be compatible with the values in the `authenticationMethods` list. For example, if `securityIntegrations` contains a SAML security integration, and `authenticationMethods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `ALL` as parameter.
func (o AuthenticationPolicyOutput) SecurityIntegrations() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) pulumi.StringArrayOutput { return v.SecurityIntegrations }).(pulumi.StringArrayOutput)
}

// Outputs the result of `SHOW AUTHENTICATION POLICIES` for the given policy.
func (o AuthenticationPolicyOutput) ShowOutputs() AuthenticationPolicyShowOutputArrayOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) AuthenticationPolicyShowOutputArrayOutput { return v.ShowOutputs }).(AuthenticationPolicyShowOutputArrayOutput)
}

// Specifies the policy for workload identity federation.
func (o AuthenticationPolicyOutput) WorkloadIdentityPolicy() AuthenticationPolicyWorkloadIdentityPolicyPtrOutput {
	return o.ApplyT(func(v *AuthenticationPolicy) AuthenticationPolicyWorkloadIdentityPolicyPtrOutput {
		return v.WorkloadIdentityPolicy
	}).(AuthenticationPolicyWorkloadIdentityPolicyPtrOutput)
}

type AuthenticationPolicyArrayOutput struct{ *pulumi.OutputState }

func (AuthenticationPolicyArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AuthenticationPolicy)(nil)).Elem()
}

func (o AuthenticationPolicyArrayOutput) ToAuthenticationPolicyArrayOutput() AuthenticationPolicyArrayOutput {
	return o
}

func (o AuthenticationPolicyArrayOutput) ToAuthenticationPolicyArrayOutputWithContext(ctx context.Context) AuthenticationPolicyArrayOutput {
	return o
}

func (o AuthenticationPolicyArrayOutput) Index(i pulumi.IntInput) AuthenticationPolicyOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *AuthenticationPolicy {
		return vs[0].([]*AuthenticationPolicy)[vs[1].(int)]
	}).(AuthenticationPolicyOutput)
}

type AuthenticationPolicyMapOutput struct{ *pulumi.OutputState }

func (AuthenticationPolicyMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AuthenticationPolicy)(nil)).Elem()
}

func (o AuthenticationPolicyMapOutput) ToAuthenticationPolicyMapOutput() AuthenticationPolicyMapOutput {
	return o
}

func (o AuthenticationPolicyMapOutput) ToAuthenticationPolicyMapOutputWithContext(ctx context.Context) AuthenticationPolicyMapOutput {
	return o
}

func (o AuthenticationPolicyMapOutput) MapIndex(k pulumi.StringInput) AuthenticationPolicyOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *AuthenticationPolicy {
		return vs[0].(map[string]*AuthenticationPolicy)[vs[1].(string)]
	}).(AuthenticationPolicyOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*AuthenticationPolicyInput)(nil)).Elem(), &AuthenticationPolicy{})
	pulumi.RegisterInputType(reflect.TypeOf((*AuthenticationPolicyArrayInput)(nil)).Elem(), AuthenticationPolicyArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*AuthenticationPolicyMapInput)(nil)).Elem(), AuthenticationPolicyMap{})
	pulumi.RegisterOutputType(AuthenticationPolicyOutput{})
	pulumi.RegisterOutputType(AuthenticationPolicyArrayOutput{})
	pulumi.RegisterOutputType(AuthenticationPolicyMapOutput{})
}
